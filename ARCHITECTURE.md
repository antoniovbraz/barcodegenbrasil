# ğŸ—ï¸ Arquitetura da AplicaÃ§Ã£o

VisÃ£o detalhada da arquitetura tÃ©cnica do projeto.

---

## ğŸ¯ VisÃ£o Geral

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      USUÃRIO (Browser)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FRONTEND (Next.js/React)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ BarcodeForm    â”‚  â”‚  HistoryList   â”‚  â”‚  page.tsx     â”‚ â”‚
â”‚  â”‚  Component     â”‚  â”‚   Component    â”‚  â”‚  (Layout)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               BACKEND (Next.js API Routes)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  /api/generate             â”‚  â”‚  /api/history        â”‚  â”‚
â”‚  â”‚  - Valida dados            â”‚  â”‚  - POST: Salva       â”‚  â”‚
â”‚  â”‚  - Gera cÃ³digos barras     â”‚  â”‚  - GET: Lista        â”‚  â”‚
â”‚  â”‚  - Cria PDF (jsPDF)        â”‚  â”‚                      â”‚  â”‚
â”‚  â”‚  - Retorna base64          â”‚  â”‚                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DATABASE (Supabase)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  generation_history                                  â”‚   â”‚
â”‚  â”‚  - id (UUID)                                         â”‚   â”‚
â”‚  â”‚  - config (JSONB)                                    â”‚   â”‚
â”‚  â”‚  - total_etiquetas (INT)                             â”‚   â”‚
â”‚  â”‚  - status (VARCHAR)                                  â”‚   â”‚
â”‚  â”‚  - created_at (TIMESTAMP)                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Estrutura de DiretÃ³rios

```
barCodeGen/
â”‚
â”œâ”€â”€ ğŸ“„ DocumentaÃ§Ã£o (16 arquivos)
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ QUICKSTART.md
â”‚   â”œâ”€â”€ FAQ.md
â”‚   â”œâ”€â”€ STEP-BY-STEP.md
â”‚   â”œâ”€â”€ TROUBLESHOOTING.md
â”‚   â”œâ”€â”€ CUSTOMIZATION.md
â”‚   â”œâ”€â”€ EXAMPLES.md
â”‚   â”œâ”€â”€ COMPARISON.md
â”‚   â”œâ”€â”€ SUMMARY.md
â”‚   â”œâ”€â”€ INSTALLATION.md
â”‚   â”œâ”€â”€ DEPLOY.md
â”‚   â”œâ”€â”€ PROJECT-STRUCTURE.md
â”‚   â”œâ”€â”€ COMMANDS.md
â”‚   â”œâ”€â”€ CHANGELOG.md
â”‚   â”œâ”€â”€ DOCUMENTATION-INDEX.md
â”‚   â””â”€â”€ PROJETO-COMPLETO.md
â”‚
â”œâ”€â”€ âš™ï¸ ConfiguraÃ§Ã£o (9 arquivos)
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ next.config.js
â”‚   â”œâ”€â”€ tailwind.config.ts
â”‚   â”œâ”€â”€ postcss.config.js
â”‚   â”œâ”€â”€ vercel.json
â”‚   â”œâ”€â”€ .gitignore
â”‚   â”œâ”€â”€ .env.example
â”‚   â””â”€â”€ .env.local.example
â”‚
â”œâ”€â”€ ğŸ—„ï¸ Banco de Dados
â”‚   â””â”€â”€ supabase-setup.sql
â”‚
â”œâ”€â”€ ğŸ’» CÃ³digo Fonte
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ app/
â”‚       â”‚   â”œâ”€â”€ api/
â”‚       â”‚   â”‚   â”œâ”€â”€ generate/
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ route.ts      â†’ GeraÃ§Ã£o de PDFs
â”‚       â”‚   â”‚   â””â”€â”€ history/
â”‚       â”‚   â”‚       â””â”€â”€ route.ts      â†’ HistÃ³rico CRUD
â”‚       â”‚   â”œâ”€â”€ layout.tsx            â†’ Layout raiz
â”‚       â”‚   â”œâ”€â”€ page.tsx              â†’ PÃ¡gina inicial
â”‚       â”‚   â””â”€â”€ globals.css           â†’ Estilos globais
â”‚       â”‚
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â”œâ”€â”€ BarcodeForm.tsx       â†’ FormulÃ¡rio principal
â”‚       â”‚   â””â”€â”€ HistoryList.tsx       â†’ Lista de histÃ³rico
â”‚       â”‚
â”‚       â”œâ”€â”€ lib/
â”‚       â”‚   â”œâ”€â”€ barcode-utils.ts      â†’ LÃ³gica de negÃ³cio
â”‚       â”‚   â””â”€â”€ supabase.ts           â†’ Cliente database
â”‚       â”‚
â”‚       â””â”€â”€ types/
â”‚           â””â”€â”€ barcode.ts            â†’ Tipos TypeScript
â”‚
â””â”€â”€ ğŸ”§ VS Code
    â””â”€â”€ .vscode/
        â”œâ”€â”€ extensions.json
        â””â”€â”€ settings.json
```

---

## ğŸ”„ Fluxo de Dados

### 1ï¸âƒ£ GeraÃ§Ã£o de CÃ³digo de Barras

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UsuÃ¡rio    â”‚ Preenche formulÃ¡rio
â”‚  preenche    â”‚ (BarcodeForm.tsx)
â”‚  formulÃ¡rio  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Valida dados (client-side)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   handleSubmit()             â”‚
â”‚   - ValidaÃ§Ã£o                â”‚
â”‚   - fetch('/api/generate')   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ POST request (JSON)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   /api/generate/route.ts               â”‚
â”‚                                        â”‚
â”‚   1. Valida configuraÃ§Ã£o               â”‚
â”‚   2. Loop (rg_inicial â†’ rg_final):     â”‚
â”‚      â”œâ”€ generateBarcodeWithText()     â”‚
â”‚      â”œâ”€ bwipjs.toBuffer() [Code128]   â”‚
â”‚      â”œâ”€ pdf.addImage()                â”‚
â”‚      â””â”€ pdf.text()                    â”‚
â”‚   3. pdf.output('arraybuffer')        â”‚
â”‚   4. Buffer.from() â†’ base64           â”‚
â”‚   5. Return { pdf: base64 }           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Response (JSON)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   handleSubmit() (continua)  â”‚
â”‚   - Recebe base64            â”‚
â”‚   - Converte para Blob       â”‚
â”‚   - Cria download link       â”‚
â”‚   - Baixa PDF                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ (opcional) POST /api/history
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   /api/history/route.ts      â”‚
â”‚   - Salva no Supabase        â”‚
â”‚   - INSERT generation_historyâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Supabase PostgreSQL        â”‚
â”‚   - Persiste registro        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2ï¸âƒ£ VisualizaÃ§Ã£o de HistÃ³rico

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Componente  â”‚ useEffect() on mount
â”‚ HistoryList  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ GET /api/history
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   /api/history/route.ts      â”‚
â”‚   - SELECT * FROM history    â”‚
â”‚   - ORDER BY created_at DESC â”‚
â”‚   - LIMIT 50                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Response (JSON array)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HistoryList (continua)     â”‚
â”‚   - setHistory(data)         â”‚
â”‚   - Renderiza lista          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© Componentes Detalhados

### Frontend Components

#### BarcodeForm.tsx
```typescript
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          BarcodeForm                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  State:                                 â”‚
â”‚  - config (BarcodeConfig)               â”‚
â”‚  - loading (boolean)                    â”‚
â”‚  - error (string | null)                â”‚
â”‚  - success (boolean)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Handlers:                              â”‚
â”‚  - handleChange()                       â”‚
â”‚  - validateForm()                       â”‚
â”‚  - handleSubmit()                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UI:                                    â”‚
â”‚  - 10 campos de input                   â”‚
â”‚  - ValidaÃ§Ã£o visual                     â”‚
â”‚  - Mensagens erro/sucesso               â”‚
â”‚  - BotÃ£o submit com loading             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### HistoryList.tsx
```typescript
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          HistoryList                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  State:                                 â”‚
â”‚  - history (GenerationHistory[])        â”‚
â”‚  - loading (boolean)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Effects:                               â”‚
â”‚  - useEffect(() => fetchHistory())      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UI:                                    â”‚
â”‚  - Lista de cards                       â”‚
â”‚  - Data formatada                       â”‚
â”‚  - Status badge                         â”‚
â”‚  - InformaÃ§Ãµes do config                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Backend Routes

#### /api/generate
```typescript
POST /api/generate
â”œâ”€ Input: BarcodeConfig (JSON)
â”œâ”€ ValidaÃ§Ãµes:
â”‚  â”œâ”€ Campos obrigatÃ³rios
â”‚  â”œâ”€ RG inicial â‰¤ RG final
â”‚  â””â”€ Total â‰¤ 1000 etiquetas
â”œâ”€ Processamento:
â”‚  â”œâ”€ Loop por RG
â”‚  â”œâ”€ Gera cÃ³digo completo
â”‚  â”œâ”€ bwip-js â†’ PNG buffer
â”‚  â”œâ”€ jsPDF â†’ adiciona imagem
â”‚  â””â”€ PrÃ³xima pÃ¡gina
â”œâ”€ Output:
â”‚  â”œâ”€ pdf (base64 string)
â”‚  â”œâ”€ totalEtiquetas (number)
â”‚  â””â”€ fileName (string)
â””â”€ Timeout: 60s mÃ¡ximo
```

#### /api/history
```typescript
GET /api/history
â”œâ”€ Input: Nenhum
â”œâ”€ Query: SELECT * ORDER BY created_at DESC LIMIT 50
â”œâ”€ Output: Array<GenerationHistory>
â””â”€ Cache: Considerar implementar

POST /api/history
â”œâ”€ Input: { config, totalEtiquetas, status }
â”œâ”€ ValidaÃ§Ã£o: Campos obrigatÃ³rios
â”œâ”€ Insert: generation_history table
â””â”€ Output: { success, data }
```

### Utilities

#### barcode-utils.ts
```typescript
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Barcode Utilities               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  formatPesoLiquido(valorKg: string)     â”‚
â”‚  â†’ Converte kg â†’ hectogramas (5 dig)    â”‚
â”‚                                         â”‚
â”‚  generateSuffix(config)                 â”‚
â”‚  â†’ Monta sufixo com:                    â”‚
â”‚     - Minerva                           â”‚
â”‚     - Peso                              â”‚
â”‚     - Data                              â”‚
â”‚     - Validade                          â”‚
â”‚     - Tara                              â”‚
â”‚                                         â”‚
â”‚  generateBarcodeWithText(config, rg)    â”‚
â”‚  â†’ CÃ³digo completo:                     â”‚
â”‚     base_fixo + RG + sufixo             â”‚
â”‚                                         â”‚
â”‚  isValidDate(dateString)                â”‚
â”‚  â†’ Valida DD/MM/YYYY                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Schema do Banco de Dados

```sql
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           generation_history                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Coluna           â”‚ Tipo                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id               â”‚ UUID (PK, DEFAULT gen...)    â”‚
â”‚ config           â”‚ JSONB (NOT NULL)             â”‚
â”‚ total_etiquetas  â”‚ INTEGER (NOT NULL)           â”‚
â”‚ status           â”‚ VARCHAR(20) DEFAULT 'completed' â”‚
â”‚ created_at       â”‚ TIMESTAMP WITH TIME ZONE     â”‚
â”‚ user_id          â”‚ UUID (NULL, future use)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ãndices:                                        â”‚
â”‚  - idx_generation_history_created_at (DESC)     â”‚
â”‚  - idx_generation_history_status                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PolÃ­ticas RLS:                                  â”‚
â”‚  - "Allow all operations" (development)         â”‚
â”‚  - Customizar para produÃ§Ã£o                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Exemplo de registro:
{
  "id": "123e4567-e89b-12d3-a456-426614174000",
  "config": {
    "base_fixo": "280000179",
    "codigo_minerva": "21789",
    "peso_liquido": "10",
    "data_producao": "18/08/2025",
    "dias_validade": 150,
    "tara": "258",
    "rg_inicial": 1,
    "rg_final": 700,
    "nome_pdf": "etiquetas.pdf"
  },
  "total_etiquetas": 700,
  "status": "completed",
  "created_at": "2025-10-30T10:30:00Z",
  "user_id": null
}
```

---

## ğŸ”Œ APIs Externas

### Supabase API
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Supabase REST API            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Endpoint:                           â”‚
â”‚  https://xxx.supabase.co/rest/v1/    â”‚
â”‚                                      â”‚
â”‚  AutenticaÃ§Ã£o:                       â”‚
â”‚  Header: apikey                      â”‚
â”‚  Header: Authorization: Bearer       â”‚
â”‚                                      â”‚
â”‚  OperaÃ§Ãµes:                          â”‚
â”‚  - POST /generation_history          â”‚
â”‚  - GET /generation_history           â”‚
â”‚                                      â”‚
â”‚  Cliente:                            â”‚
â”‚  @supabase/supabase-js              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Deploy Architecture (Vercel)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Vercel Edge Network                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  CDN Global (200+ localizaÃ§Ãµes)           â”‚  â”‚
â”‚  â”‚  - Cache de assets                        â”‚  â”‚
â”‚  â”‚  - HTTPS automÃ¡tico                       â”‚  â”‚
â”‚  â”‚  - DDoS protection                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â”‚                               â”‚
â”‚                  â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Serverless Functions (AWS Lambda)        â”‚  â”‚
â”‚  â”‚  - /api/generate (Node.js 18)             â”‚  â”‚
â”‚  â”‚  - /api/history (Node.js 18)              â”‚  â”‚
â”‚  â”‚  - Timeout: 60s (Hobby)                   â”‚  â”‚
â”‚  â”‚  - Memory: 1024MB                         â”‚  â”‚
â”‚  â”‚  - Cold start: ~100ms                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â”‚                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Supabase (AWS)                        â”‚
â”‚  - PostgreSQL 15                                 â”‚
â”‚  - Region: Sua escolha                           â”‚
â”‚  - Backups automÃ¡ticos                           â”‚
â”‚  - Connection pooling                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Performance Considerations

### Client-Side
```
OtimizaÃ§Ãµes:
âœ… Code splitting automÃ¡tico (Next.js)
âœ… Lazy loading de componentes
âœ… CSS minificado (Tailwind)
âœ… Tree shaking (imports otimizados)

MÃ©tricas Alvo:
- First Contentful Paint: <1.5s
- Largest Contentful Paint: <2.5s
- Time to Interactive: <3.5s
- Cumulative Layout Shift: <0.1
```

### Server-Side
```
OtimizaÃ§Ãµes:
âœ… Serverless functions (escala automÃ¡tica)
âœ… Cache de assets no CDN
âœ… CompressÃ£o gzip/brotli
âœ… Database connection pooling

Limites (Vercel Hobby):
- Timeout: 60s
- Memory: 1024MB
- Executions: 100GB-hours/mÃªs
- Bandwidth: 100GB/mÃªs
```

### Database
```
OtimizaÃ§Ãµes:
âœ… Ãndices em created_at e status
âœ… JSONB para config (flexÃ­vel)
âœ… Connection pooling
âœ… Prepared statements

Queries otimizadas:
- SELECT com LIMIT
- INDEX SCAN (nÃ£o full scan)
- Order by indexed column
```

---

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Security Layers                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Network (Vercel)                          â”‚
â”‚     âœ… HTTPS only                             â”‚
â”‚     âœ… DDoS protection                        â”‚
â”‚     âœ… WAF (Web Application Firewall)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. Application (Next.js)                     â”‚
â”‚     âœ… Input validation                       â”‚
â”‚     âœ… CORS configured                        â”‚
â”‚     âœ… No exposed secrets                     â”‚
â”‚     âœ… Environment variables                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. Database (Supabase)                       â”‚
â”‚     âœ… Row Level Security (RLS)               â”‚
â”‚     âœ… Connection encryption                  â”‚
â”‚     âœ… API key authentication                 â”‚
â”‚     âœ… Service role isolated                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4. CÃ³digo                                    â”‚
â”‚     âœ… TypeScript (type safety)               â”‚
â”‚     âœ… ESLint rules                           â”‚
â”‚     âœ… No eval() ou dangerous code            â”‚
â”‚     âœ… Dependency scanning                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª Testing Strategy (Futuro)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Testing Pyramid             â”‚
â”‚                                     â”‚
â”‚         â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²              â”‚
â”‚        â•±   E2E Tests  â•²             â”‚
â”‚       â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²            â”‚
â”‚      â•±  Integration     â•²           â”‚
â”‚     â•±â”€â”€â”€â”€â”€â”€Testsâ”€â”€â”€â”€â”€â”€â”€â”€â”€â•²          â”‚
â”‚    â•±   Unit Tests         â•²         â”‚
â”‚   â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²        â”‚
â”‚                                     â”‚
â”‚  Unit: Jest + RTL                   â”‚
â”‚  Integration: API tests             â”‚
â”‚  E2E: Playwright                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Monitoring & Observability

```
Recomendado implementar:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Logs                               â”‚
â”‚  - Console.log estruturado          â”‚
â”‚  - Vercel logs dashboard            â”‚
â”‚  - Error tracking (Sentry?)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Metrics                            â”‚
â”‚  - Response time                    â”‚
â”‚  - Error rate                       â”‚
â”‚  - Success rate                     â”‚
â”‚  - Throughput                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Alerts                             â”‚
â”‚  - Error threshold                  â”‚
â”‚  - Performance degradation          â”‚
â”‚  - Quota warnings                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ CI/CD Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          GitHub â†’ Vercel Pipeline            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  1. Developer                                â”‚
â”‚     git push origin main                     â”‚
â”‚          â”‚                                   â”‚
â”‚          â–¼                                   â”‚
â”‚  2. GitHub                                   â”‚
â”‚     - Webhook to Vercel                      â”‚
â”‚     - Code stored                            â”‚
â”‚          â”‚                                   â”‚
â”‚          â–¼                                   â”‚
â”‚  3. Vercel Build                             â”‚
â”‚     - Install dependencies                   â”‚
â”‚     - npm run build                          â”‚
â”‚     - Run checks                             â”‚
â”‚     - Generate static assets                 â”‚
â”‚          â”‚                                   â”‚
â”‚          â–¼                                   â”‚
â”‚  4. Deploy                                   â”‚
â”‚     - Upload to CDN                          â”‚
â”‚     - Deploy functions                       â”‚
â”‚     - Update routing                         â”‚
â”‚          â”‚                                   â”‚
â”‚          â–¼                                   â”‚
â”‚  5. Live! ğŸš€                                 â”‚
â”‚     - New deployment URL                     â”‚
â”‚     - Automatic preview                      â”‚
â”‚     - Production update                      â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tempo total: ~2 minutos
```

---

## ğŸ¯ ConclusÃ£o da Arquitetura

### Pontos Fortes âœ…
- **Serverless:** Escala automÃ¡tica
- **Type-safe:** TypeScript em toda stack
- **Modern:** React 18 + Next.js 14
- **Fast:** Edge network + optimizations
- **Reliable:** PostgreSQL robusto
- **Secure:** MÃºltiplas camadas de seguranÃ§a

### ConsideraÃ§Ãµes âš ï¸
- Limite de 60s timeout (Vercel Hobby)
- Cold start em funÃ§Ãµes serverless
- Custos escalam com uso
- DependÃªncia de serviÃ§os terceiros

### Melhorias Futuras ğŸš€
- [ ] Implementar cache (Redis)
- [ ] Adicionar fila de processamento
- [ ] Testes automatizados
- [ ] Monitoramento avanÃ§ado
- [ ] Rate limiting
- [ ] AutenticaÃ§Ã£o

---

**Esta arquitetura suporta:**
- âœ… Milhares de usuÃ¡rios simultÃ¢neos
- âœ… GeraÃ§Ãµes de PDFs rÃ¡pidas
- âœ… Alta disponibilidade
- âœ… FÃ¡cil manutenÃ§Ã£o
- âœ… Escalabilidade horizontal

ğŸ‰ **Pronta para produÃ§Ã£o!**
